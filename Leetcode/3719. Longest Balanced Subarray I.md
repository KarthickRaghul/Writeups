
**Question :**

You are given an integer array `nums`. A is called **balanced** if the number of **distinct even** numbers in the subarray is equal to the number of **distinct odd** numbers. Return the length of the **longest** balanced subarray.

**Example 1:**

> **Input:** nums = [2,5,4,3]
> 
> **Output:** 4
> 
> **Explanation:**
> 
>  - The longest balanced subarray is `[2, 5, 4, 3]`.  
> - It has 2 distinct even numbers `[2, 4]` and 2 distinct odd numbers `[5, 3]`. Thus, the answer is 4.

**Example 2:**

> **Input:** nums = [3,2,2,5,4]
> 
> **Output:** 5
> 
> **Explanation:**
> 
> - The longest balanced subarray is `[3, 2, 2, 5, 4]`.  
> - It has 2 distinct even numbers `[2, 4]` and 2 distinct odd numbers `[3, 5]`. Thus, the answer is 5.

**Example 3:**

> **Input:** nums = [1,2,3,2]
> 
> **Output:** 3
> 
> **Explanation:**
> 
> - The longest balanced subarray is `[2, 3, 2]`.  
> - It has 1 distinct even number `[2]` and 1 distinct odd number `[3]`. Thus, the answer is 3.

**Constraints:**

- `1 <= nums.length <= 1500`
- `1 <= nums[i] <= 105`

**Solution:**

O(N^2)
```java
class Solution {
    public int longestBalanced(int[] nums) {
        int res = 0;
        for (int i = 0; i < nums.length; i++) {
            int evencount = 0, oddcount = 0;
            Set<Integer> set = new HashSet<>();
            for (int j = i; j < nums.length; j++) {
                if (!set.contains(nums[j])) {
                    set.add(nums[j]);
                    if (nums[j] % 2 == 0)
                        evencount++;
                    else
                        oddcount++;
                }
                if (evencount == oddcount)
                    res = Math.max(res, j - i + 1);
            }
        }
        return res;
    }
}
```

**Optimal: **

```java
class Solution {
    public int longestBalanced(int[] nums) {
        int n = nums.length;
        int[] seenEven = new int[100001];
        int[] seenOdd = new int[100001];
        int evenCount;
        int oddCount;
        int time = 1;
        int ans = 0;
        for (int i = 0; i < n; i++) {
            evenCount = 0;
            oddCount = 0;
            time++;
            for (int j = i; j < n; j++) {
                int x = nums[j];
                if (x % 2 == 0) {
                    if (seenEven[x] != time) {
                        seenEven[x] = time;
                        evenCount++;
                    }
                } else {
                    if (seenOdd[x] != time) {
                        seenOdd[x] = time;
                        oddCount++;
                    }
                }
                if (evenCount == oddCount) {
                    int len = j - i + 1;
                    if (len > ans) {
                        ans = len;
                    }
                }
            }
        }
        return ans;
    }
}
```

.